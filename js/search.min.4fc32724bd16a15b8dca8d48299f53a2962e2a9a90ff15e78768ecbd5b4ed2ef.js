function delay(b,c){let a=0;return function(){let d=this,e=arguments;clearTimeout(a),a=setTimeout(function(){b.apply(d,e)},c||0)}}function escape(a){return a.replace(/[^0-9A-Za-z ]/g,a=>"&#"+a.charCodeAt(0)+";")}function replaceQueryParam(a,b,d){let e=new RegExp("([?;&])"+a+"[^&;]*[;&]?"),c=d.replace(e,"$1").replace(/&$/,'');return(c.length>2?c+"&":"?")+(b?a+"="+b:'')}function getDOMFilters(){let a={q:"",excludeAllergens:[],includeTaxonomies:{}};a.q=document.getElementById("search-query").value.trim();let b=document.getElementsByClassName("filter-checkbox");for(let c=0;c<b.length;c++){let d=b[c].getAttribute("data-filter-key"),e=b[c].getAttribute("data-filter-value");if(b[c].checked){if(d==="allergens"){a.excludeAllergens.push(e);continue}a.includeTaxonomies[d]=a.includeTaxonomies[d]||[],a.includeTaxonomies[d].push(e)}}return a}function setDOMFilters(a){document.getElementById("search-query").value=a.q;let b=document.getElementsByClassName("filter-checkbox");for(let a=0;a<b.length;a++)b[a].checked=!1;for(let b=0;b<a.excludeAllergens.length;b++)document.getElementById("filterallergens"+a.excludeAllergens[b]).checked=!0;for(let b in a.includeTaxonomies)for(let c=0;c<a.includeTaxonomies[b].length;c++)document.getElementById("filter"+b+a.includeTaxonomies[b][c]).checked=!0}function existsInRecipe(a,b){return function(c){return!!a.params[b]&&(!!(Array.isArray(a.params[b])&&a.params[b].includes(c))||(a.params[b]===c))}}function negate(a){return function(...b){return!a(...b)}}function scoreMultiWordSearch(a,c){if(c.includes(a))return 0;let b=a.indexOf(" ");if(b>-1)while(b>-1){if(before=a.slice(0,b),after=a.slice(b+1,a.length),score1=scoreMultiWordSearch(before,c)-100,score2=scoreMultiWordSearch(after,c)-100,score1!=-(1/0)||score2!=-(1/0))return Math.max(score1,score2);b=a.indexOf(" ",b+1)}return-(1/0)}function filterRecipes(c,a){let b=c;a.q&&(b=c.map(b=>{let d=scoreMultiWordSearch(a.q.toLowerCase(),b.title.toLowerCase()),e=scoreMultiWordSearch(a.q.toLowerCase(),b.body.toLowerCase()),c={...b};if(d>-(1/0))c.searchScore=d;else if(e>-(1/0)){let a=5;c.searchScore=(e-100)*a}return c}).sort((a,b)=>a.searchScore<=b.searchScore?1:-1).filter(a=>a.searchScore>-(1/0)));let d=[];for(let c=0;c<b.length;c++){let e=b[c];if(a.excludeAllergens.some(existsInRecipe(e,"allergens")))continue;if(Object.keys(a.includeTaxonomies).some(b=>a.includeTaxonomies[b].every(negate(existsInRecipe(e,b)))))continue;d.push(e)}return d}function updateRecipeDOM(a){let b="";for(const d in a){let c=a[d],e="."+c.relPermalink;b+='<li class="recipe-listing-item col"><a href=".'+e+'" role="article">'+'<div class="card h-100">'+(c.params.previewimage?'<img loading="lazy" src="'+c.params.previewimage+'" class="card-image-top mx-1 mt-1" alt="Delicious-looking image of '+escape(c.title)+'" />':"")+'<div class="card-body">'+'<span class="meta">'+escape(c.params.meals)+"/"+escape(c.params.difficulties)+"</span>"+'<h4 class="display-5 mt-lg-3">'+escape(c.title)+"</h2>"+"</div>"+"</div>"+"</a>"+"</li>"}document.getElementById("recipe-listing").innerHTML=b}function onLoad(){let a=new URL(document.location).searchParams;document.getElementById("search-query").value=a.get("q"),fetch("index.json").then(a=>a.json()).then(a=>{window.recipesData=a;let b=getDOMFilters(),c=filterRecipes(window.recipesData||[],b);updateRecipeDOM(c),document.getElementById("page-title").innerHTML="Recipes"})}document.addEventListener("DOMContentLoaded",onLoad),document.readyState!=="loading"&&onLoad(),document.getElementById("search-query").addEventListener("input",delay(()=>{let a=getDOMFilters(),b=filterRecipes(window.recipesData||[],a);updateRecipeDOM(b);let c=window.location.search,d=replaceQueryParam("q",a.q,c);history.pushState(a,document.title,d)},400));const checkboxes=document.getElementsByClassName("filter-checkbox");for(let a=0;a<checkboxes.length;a++)checkboxes[a].addEventListener("change",()=>{let a=getDOMFilters(),b=filterRecipes(window.recipesData||[],a);updateRecipeDOM(b),history.pushState(a,document.title)});window.addEventListener("popstate",b=>{let a=b.state;b.state||(a={q:"",excludeAllergens:[],includeTaxonomies:{}}),setDOMFilters(a);let c=filterRecipes(window.recipesData||[],a);updateRecipeDOM(c)})